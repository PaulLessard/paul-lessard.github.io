% Site-wide standard header latex files

% Imports of general utility packages
\usepackage{wrapfig}
\usepackage{graphicx}
\usepackage{realscripts}
\usepackage{transparent}
\usepackage{etoolbox}
\usepackage{amsxtra}
\usepackage{mathtools}

% Setup tikz and tikz cd
\usepackage{tikz}

\usetikzlibrary{cd}
\usetikzlibrary{matrix}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{trees}
\usetikzlibrary{backgrounds}
\usetikzlibrary{graphs}
\usetikzlibrary{calc}

% Setup preview package for generation of equation images
\usepackage[tightpage,pdftex,delayed]{preview}

\ifPreview%
    \makeatletter
    \newenvironment{doms@math}{\(}{\)}
    \PreviewEnvironment{doms@math}
    \newcounter{doms@page}    
    \newenvironment{shipper}[2]{%
        \gdef\doms@eqnno{#2}%
        \stepcounter{doms@page}
        \hbox{\begingroup\aftergroup}\begin{doms@math}\m@th#1{\begingroup\aftergroup}}{%
        \endgroup\end{doms@math}\endgroup}
    \pretocmd{\pr@ship@end}{%
    \typeout{Preview: img#\arabic{doms@page} eqn#\doms@eqnno\space dims \the\dp\pr@box,\the\ht\pr@box,\the\wd\pr@box.}}{%
    \typeout{Preview: box dimension printer successfully installed.}}{%
    \typeout{Preview: box dimension printer not installed!}}
    \typeout{Preview: border \the\PreviewBorder.}
    \makeatother
\else
    \newenvironment{shipper}[2]{}{}
\fi

%\tikzset{
%  commutative diagrams/.cd, 
%  arrow style=tikz, 
%  diagrams={>=Straight Barb, semithick}
%}

% Differential styling of diagrams, colours, font sizes and so
% forth in normal and preview modes

\ifPreview%
    \def\adjustcolor{\color[HTML]{515151}\transparent{1}}
    \AtBeginDocument{\adjustcolor}
    \everymath{\adjustcolor}
    \everydisplay{\adjustcolor}

    \tikzset{every picture/.style={scale=1.41137}}
\fi